---
title: "Statistiche Sociali e Geopolitiche"
output: html_document
---

## Dati e strumenti per interpretare dinamiche sociali e globali

Il sito raccoglie analisi statistiche su temi di rilevanza sociale e geopolitica, con l’obiettivo di promuovere un approccio empirico allo studio delle trasformazioni contemporanee. Uno spazio per ricercatori, studenti e cittadini interessati ai dati come strumento di conoscenza.

---

## Donne che hanno subito violenza fisica da un partner intimo

### Dati Eurostat

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=5, out.width="100%", fig.align="left"}
library(eurostat)
library(kableExtra)
library(dplyr)
library(data.table)

# Women who have experienced violence by a non-partner, by type of violence   
B1 <- get_eurostat("gbv_ipv_type" , cache = TRUE, update_cache = FALSE)
B2 <- label_eurostat(B1)
setDT(B2)


library(ggplot2)
library(dplyr)
library(stringr)

B2_clean <- as.data.frame(B2)
B2_clean <- na.omit(B2_clean)

B2_filtered_geo <- B2_clean %>%
  filter(geo != "European Union (aggregate changing according to the context)")

physical_violence_data <- B2_filtered_geo %>%
  filter(str_detect(violence, "(?i)Physical"))

summary_physical_violence_by_country <- physical_violence_data %>%
  group_by(geo) %>%
  summarise(
    avg_physical_violence = mean(values, na.rm = TRUE),
    .groups = 'drop'
  ) %>%
  arrange(desc(avg_physical_violence))

plot_physical_violence_geo <- ggplot(summary_physical_violence_by_country,
                                     aes(x = reorder(geo, -avg_physical_violence),
                                         y = avg_physical_violence,
                                         fill = avg_physical_violence)) +
  geom_bar(stat = "identity") +
  scale_fill_gradient(low = "lightblue", high = "darkred") +
  labs(
    x = "Paese",
    y = "Percentuale Media di Violenza Fisica (%)",
    fill = "Percentuale"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 60, hjust = 1, size = 9),
    axis.title.x = element_blank(),
    legend.position = "right"
  )

plot_physical_violence_geo


```













---

## Economia Italiana Anno 2024

Il grafico mette a confronto i principali indicatori economici relativi agli Stati Uniti e all’Italia, includendo le esportazioni totali negli USA, le esportazioni complessive italiane, il prodotto interno lordo italiano, le importazioni totali e gli investimenti.

Questa rappresentazione aiuta a comprendere le dimensioni relative di queste grandezze economiche e il ruolo fondamentale delle esportazioni e degli investimenti nello sviluppo economico.

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=5, out.width="100%", fig.align="left"}

library(ggplot2)
library(tibble)

dataset <- tribble(
  ~Categoria,           ~Valore,
  "Esport Tot in USA",  64.8,
  "Esport Tot",         623.5,
  "PIL",                2192.2,
  "Importazioni Tot",   568.7 ,
  "Investimenti",       370
)

colori_pastello <- c("#AEC7E8", "#FFBB78", "#98DF8A", "#FF9896", "#C5B0D5")

# Ordina per categoria (come in plotly)
dataset$Categoria <- factor(dataset$Categoria, levels = dataset$Categoria)

# Grafico statico
ggplot(dataset, aes(x = Categoria, y = Valore, fill = Categoria)) +
  geom_col(color = "grey30", width = 0.7, show.legend = FALSE) +
  geom_text(
    aes(label = Valore),
    vjust = -0.7,
    size = 4,
    family = "Arial"
  ) +
  scale_fill_manual(values = colori_pastello) +
  scale_y_continuous(
    limits = c(0, max(dataset$Valore) * 1.15),
    expand = c(0, 0),
    name = "Milardi di €"
  ) +
  labs(x = NULL) +
  theme_minimal(base_family = "Arial") +
  theme(
    plot.background = element_rect(fill = "white", color = NA),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(color = "lightgrey", linetype = "dotted"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, color = "grey20"),
    axis.text.y = element_text(size = 8, color = "grey20"),
    axis.title.y = element_text(size = 12, color = "black", face = "plain"),
    plot.margin = margin(t = 20, r = 20, b = 60, l = 0)
  )
```

---

## Tendenze dei Matrimoni in Italia

Esplora le profonde trasformazioni sociali che hanno interessato l'Italia attraverso l'analisi dei dati sui matrimoni. Questo grafico illustra il costante declino del numero di unioni, partendo dalle medie del dopoguerra (1946-1970) fino al dato del 2023. Una rappresentazione chiara che evidenzia i cambiamenti demografici, culturali ed economici che stanno ridefinendo la struttura della famiglia e delle relazioni nel nostro paese.


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=5, out.width="100%", fig.align="left"}

library(ggplot2)
library(tibble)

dataset <- tribble(
  ~Categoria,           ~Valore,
  "Media 1946-1970",  400,
  "1990",             290,
  "2000",             284,
  "2010",             217,
  "2023",             184
)

colori_pastello <- c("#AEC7E8", "#FFBB78", "#98DF8A", "#FF9896", "#C5B0D5")

# Ordina per categoria (come in plotly)
dataset$Categoria <- factor(dataset$Categoria, levels = dataset$Categoria)

# Grafico statico
ggplot(dataset, aes(x = Categoria, y = Valore, fill = Categoria)) +
  geom_col(color = "grey30", width = 0.7, show.legend = FALSE) +
  geom_text(
    aes(label = Valore),
    vjust = -0.7,
    size = 4,
    family = "Arial"
  ) +
  scale_fill_manual(values = colori_pastello) +
  scale_y_continuous(
    limits = c(0, max(dataset$Valore) * 1.15),
    expand = c(0, 0),
    name = "Mila Unità"
  ) +
  labs(x = NULL) +
  theme_minimal(base_family = "Arial") +
  theme(
    plot.background = element_rect(fill = "white", color = NA),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(color = "lightgrey", linetype = "dotted"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, color = "grey20"),
    axis.text.y = element_text(size = 8, color = "grey20"),
    axis.title.y = element_text(size = 12, color = "black", face = "plain"),
    plot.margin = margin(t = 20, r = 20, b = 60, l = 0)
  )
```

















