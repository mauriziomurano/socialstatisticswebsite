---
title: "Statistiche Sociali e Geopolitiche"
output: html_document
---

## Dati e strumenti per interpretare dinamiche sociali e globali

Il sito raccoglie analisi statistiche su temi di rilevanza sociale e geopolitica, con l’obiettivo di promuovere un approccio empirico allo studio delle trasformazioni contemporanee. Uno spazio per ricercatori, studenti e cittadini interessati ai dati come strumento di conoscenza.







---

## Vittime in contesti di conflitto

Il grafico presenta un confronto quantitativo immediato di diverse categorie, mescolando dati relativi alle vittime in contesti di conflitto recenti e storici con la dimensione delle popolazioni coinvolte. 

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=5, out.width="100%", fig.align="left"}

library(ggplot2)
library(tibble)
library(dplyr)
library(stringr) # Necessario per la funzione str_wrap

dataset <- tribble(
  ~Categoria,                 ~Valore,
  "Soldati russi caduti Mag 25", 250000,
  "Soldati ucraini caduti Mag 25", 80000,
  "Civili ucraini caduti Mag 25", 13000,
  "Popolazione palestinese", 5000000,
  "Vittime palestinesi Mag 25", 62000,
  "Popolazione armena", 1800000,
  "Vittime armene 15-23", 1500000,
  "Popolazione ebrea in Europa 1939", 7000000, 
  "Vittime ebree dell'olocausto", 6000000
)

# 1. Preparazione dei Dati (Etichetta e Formattazione)
dataset <- dataset %>%
  mutate(
    # Etichetta sopra le barre: Milioni per valori >= 1M, altrimenti valore intero formattato
    Etichetta_Formattata = case_when(
      Valore >= 1000000 ~ paste0(round(Valore / 1000000, 1), "M"),
      TRUE ~ format(Valore, big.mark = ".", scientific = FALSE)
    ),
    # Nuova colonna per l'etichetta dell'asse X con a capo
    Categoria_Wrapped = str_wrap(Categoria, width = 14) # Larghezza massima di 15 caratteri per riga
  )

# Ordina per la categoria originale, ma usa la colonna wrapped nel grafico
dataset$Categoria_Wrapped <- factor(
  dataset$Categoria_Wrapped, 
  levels = str_wrap(dataset$Categoria, width = 14)
)

# Grafico statico con le etichette corrette
ggplot(dataset, aes(x = Categoria_Wrapped, y = Valore, fill = Valore)) +
  geom_col(color = "grey30", width = 0.7, show.legend = FALSE) +
  geom_text(
    # Usa la colonna formattata per le etichette sopra le barre
    aes(label = Etichetta_Formattata),
    vjust = -0.7,
    size = 4,
    family = "Arial"
  ) +
  scale_fill_gradient(low = "lightblue", high = "darkblue") + 
  scale_y_continuous(
    limits = c(0, max(dataset$Valore) * 1.15),
    expand = c(0, 0),
    labels = scales::label_number(scale = 1e-6, suffix = "M", accuracy = 1),
    name = " "
  ) +
  labs(x = NULL) +
  theme_minimal(base_family = "Arial") +
  theme(
    plot.background = element_rect(fill = "white", color = NA),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(color = "grey", linetype = "dotted"),
    # Rimosso angle = 45, perché il testo va a capo
    axis.text.x = element_text(hjust = 0.5, size = 10, color = "grey20"), 
    axis.text.y = element_text(size = 8, color = "grey20"),
    axis.title.y = element_text(size = 12, color = "black", face = "plain"),
    plot.margin = margin(t = 20, r = 20, b = 60, l = 0)
  )
```


---


## Vittime (civili e militari) in una serie di conflitti e genocidi storici

Il grafico presenta una comparazione quantitativa delle stime delle vittime (civili e militari) in una serie di conflitti e genocidi storici e contemporanei, evidenziando le estreme differenze di scala che caratterizzano la violenza umana.

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=5, out.width="100%", fig.align="left"}

library(ggplot2)
library(tibble)
library(dplyr)
library(stringr) # Necessario per la funzione str_wrap

dataset <- tribble(
  ~Categoria,                 ~Valore,
  "Olocausto (1941-1945)", 6000000,
  "Genocidio armeno (1915-1923)", 2500000,
  "Genocidio del Ruanda (1994)", 800000,
  "Genocidio cambogiano (1975-1979)", 1500000,
  "Vittime palestinesi Mag 25", 62000,
  "Seconda Guerra Mondiale", 70000000,
  "Prima Guerra Mondiale", 16000000,
  "Conflitto in Etiopia", 100000, 
  "Guerra in Siria", 500000, 
  "Guerra in Yemen", 18000,

)

# 1. Preparazione dei Dati (Etichetta e Formattazione)
dataset <- dataset %>%
  mutate(
    # Etichetta sopra le barre: Milioni per valori >= 1M, altrimenti valore intero formattato
    Etichetta_Formattata = case_when(
      Valore >= 1000000 ~ paste0(round(Valore / 1000000, 1), "M"),
      TRUE ~ format(Valore, big.mark = ".", scientific = FALSE)
    ),
    # Nuova colonna per l'etichetta dell'asse X con a capo
    Categoria_Wrapped = str_wrap(Categoria, width = 14) # Larghezza massima di 15 caratteri per riga
  )

# Ordina per la categoria originale, ma usa la colonna wrapped nel grafico
dataset$Categoria_Wrapped <- factor(
  dataset$Categoria_Wrapped, 
  levels = str_wrap(dataset$Categoria, width = 14)
)

# Grafico statico con le etichette corrette
ggplot(dataset, aes(x = Categoria_Wrapped, y = Valore, fill = Valore)) +
  geom_col(color = "grey30", width = 0.7, show.legend = FALSE) +
  geom_text(
    # Usa la colonna formattata per le etichette sopra le barre
    aes(label = Etichetta_Formattata),
    vjust = -0.7,
    size = 4,
    family = "Arial"
  ) +
  scale_fill_gradient(low = "lightblue", high = "darkblue") + 
  scale_y_continuous(
    limits = c(0, max(dataset$Valore) * 1.15),
    expand = c(0, 0),
    labels = scales::label_number(scale = 1e-6, suffix = "M", accuracy = 1),
    name = " "
  ) +
  labs(x = NULL) +
  theme_minimal(base_family = "Arial") +
  theme(
    plot.background = element_rect(fill = "white", color = NA),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(color = "grey", linetype = "dotted"),
    # Rimosso angle = 45, perché il testo va a capo
    axis.text.x = element_text(hjust = 0.5, size = 10, color = "grey20"), 
    axis.text.y = element_text(size = 8, color = "grey20"),
    axis.title.y = element_text(size = 12, color = "black", face = "plain"),
    plot.margin = margin(t = 20, r = 20, b = 60, l = 0)
  )
```


---






## Donne che hanno subito violenza fisica da un partner intimo

### Dati Eurostat ANNO 2021

```{r, echo=FALSE, message=FALSE, warning=FALSE, out.width="100%", fig.align="left"}
library(eurostat)
library(kableExtra)
library(dplyr)
library(data.table)

# Women who have experienced violence by a non-partner, by type of violence   
A <- get_eurostat("gbv_ipv_type" , cache = TRUE, update_cache = FALSE)
B <- label_eurostat(A)
setDT(B)
C <- B[, -c(1, 3, 5)]
C[[1]] <- as.factor(C[[1]])
C[[2]] <- as.factor(C[[2]])
C <- C[!grepl("European Union \\(aggregate changing according to the context\\)", geo)]

C <- C[grepl("Physical", violence)]

library(ggplot2)
library(dplyr)

C_cleaned <- C %>%
  filter(!is.na(values))

ggplot(C_cleaned, aes(x = geo, y = values, fill = values)) + # Cambiato 'fill = geo' a 'fill = values'
  geom_col(show.legend = FALSE) + # show.legend = TRUE per mostrare la legenda del colore
  labs(
    x = "",
    y = ""
  ) +
  scale_fill_gradient(low = "lightblue", high = "darkblue") + # Scala di colore dal blu chiaro al blu scuro
  theme_minimal(base_size = 10) +
  theme(
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, size = 8),
    panel.spacing = unit(1.5, "lines"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    strip.text = element_text(size = 9, face = "bold", margin = margin(b = 5)),
    plot.margin = margin(t = 10, r = 10, b = 10, l = 10)
  ) +
  facet_wrap(~ violence, scales = "free_x", ncol = 2)

```













---

## Economia Italiana Anno 2024

Il grafico mette a confronto i principali indicatori economici relativi agli Stati Uniti e all’Italia, includendo le esportazioni totali negli USA, le esportazioni complessive italiane, il prodotto interno lordo italiano, le importazioni totali e gli investimenti.

Questa rappresentazione aiuta a comprendere le dimensioni relative di queste grandezze economiche e il ruolo fondamentale delle esportazioni e degli investimenti nello sviluppo economico.

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=5, out.width="100%", fig.align="left"}

library(ggplot2)
library(tibble)

dataset <- tribble(
  ~Categoria,           ~Valore,
  "Esport Tot in USA",  64.8,
  "Esport Tot",         623.5,
  "PIL",                2192.2,
  "Importazioni Tot",   568.7 ,
  "Investimenti",       370
)

# Non useremo più colori_pastello per il riempimento, ma lo mantengo se ti serve per altro
# colori_pastello <- c("#AEC7E8", "#FFBB78", "#98DF8A", "#FF9896", "#C5B0D5")

# Ordina per categoria (come in plotly)
dataset$Categoria <- factor(dataset$Categoria, levels = dataset$Categoria)

# Grafico statico con sfumature di colore basate sul valore
ggplot(dataset, aes(x = Categoria, y = Valore, fill = Valore)) + # Cambiato fill = Categoria a fill = Valore
  geom_col(color = "grey30", width = 0.7, show.legend = FALSE) + # show.legend = TRUE per la barra del colore
  geom_text(
    aes(label = Valore),
    vjust = -0.7,
    size = 4,
    family = "Arial"
  ) +
  scale_fill_gradient(low = "lightblue", high = "darkblue") + 
  scale_y_continuous(
    limits = c(0, max(dataset$Valore) * 1.15),
    expand = c(0, 0),
    name = "Milardi di €"
  ) +
  labs(x = NULL) +
  theme_minimal(base_family = "Arial") +
  theme(
    plot.background = element_rect(fill = "white", color = NA),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(color = "grey", linetype = "dotted"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, color = "grey20"),
    axis.text.y = element_text(size = 8, color = "grey20"),
    axis.title.y = element_text(size = 12, color = "black", face = "plain"),
    plot.margin = margin(t = 20, r = 20, b = 60, l = 0)
  )
```

---

## Tendenze dei Matrimoni in Italia

Esplora le profonde trasformazioni sociali che hanno interessato l'Italia attraverso l'analisi dei dati sui matrimoni. Questo grafico illustra il costante declino del numero di unioni, partendo dalle medie del dopoguerra (1946-1970) fino al dato del 2023. Una rappresentazione chiara che evidenzia i cambiamenti demografici, culturali ed economici che stanno ridefinendo la struttura della famiglia e delle relazioni nel nostro paese.


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=5, out.width="100%", fig.align="left"}

library(ggplot2)
library(tibble)

dataset <- tribble(
  ~Categoria,           ~Valore,
  "Media 1946-1970",  400,
  "1990",             290,
  "2000",             284,
  "2010",             217,
  "2023",             184
)

# I colori_pastello non saranno usati per il riempimento, ma vengono mantenuti se necessari per altri scopi.
# colori_pastello <- c("#AEC7E8", "#FFBB78", "#98DF8A", "#FF9896", "#C5B0D5")

# Ordina per categoria (come in plotly)
dataset$Categoria <- factor(dataset$Categoria, levels = dataset$Categoria)

# Grafico statico con sfumature di colore basate sul Valore
ggplot(dataset, aes(x = Categoria, y = Valore, fill = Valore)) + # Cambiato 'fill = Categoria' a 'fill = Valore'
  geom_col(color = "grey30", width = 0.7, show.legend = FALSE) + # show.legend = TRUE per mostrare la legenda del colore
  geom_text(
    aes(label = Valore),
    vjust = -0.7,
    size = 4,
    family = "Arial"
  ) +
  scale_fill_gradient(low = "lightblue", high = "darkblue") + 
  scale_y_continuous(
    limits = c(0, max(dataset$Valore) * 1.15),
    expand = c(0, 0),
    name = "Mila Unità"
  ) +
  labs(x = NULL) +
  theme_minimal(base_family = "Arial") +
  theme(
    plot.background = element_rect(fill = "white", color = NA),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(color = "grey", linetype = "dotted"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, color = "grey20"),
    axis.text.y = element_text(size = 8, color = "grey20"),
    axis.title.y = element_text(size = 12, color = "black", face = "plain"),
    plot.margin = margin(t = 20, r = 20, b = 60, l = 0)
  )
```

















